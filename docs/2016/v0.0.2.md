# v0.0.2 Release Notes

## Scalling



### Service Host

Each application act as an Service Composite Application. Consists of one or more [Service](src/Pi/Service.php) available at a specific endpoint.

There isn't a ServiceRegister responsible for balancing requests to the proper hosts instances.

The load balancing should be made from a third party like nginx itself. It's expected that the web server will send the requests to the more healthy servers.

Example for 4 services: news, users, events, products
1.1.1.1 - news, users
1.1.1.2 - news, events
1.1.1.3 - products

Each server is configured with the same base URL: https://lusify.com/api


This is the order of operation 
+ < 1.1.1.1 built and deploy
+ < 1.1.1.1 assumes leader
+ > 2.2.2.1 request /news/get
..+ 1.1.1.1 handles the operation
+ < 1.1.1.2 built and deploy
+ > 2.2.2.1 request /events/get
..+ 1.1.1.1 - send to 1.1.1.2  
+ < 1.1.1.3 built and deply
+ > 2.2.2.2 request news/get
..+ 1.1.1.1 - send to 1.1.1.2 (is capable of handling but it's busy with last operation)


https://lusify.com/api/news - 1.1.1.1
https://lusify.com/api/users - 1.1.1.2

There're

When a server receive a request, if it ca

#### Deploy

When the application is built, if it's on scalling mode the host will deploy itself.

The depl

### Service Gateway

Built on top of Pi, the Service Gateway allow to develop more loosely-coupled services. 

### Service Discovery

Service Discovery is based on ServiceStack implementation. We have two important interfaces: [ServiceGatewayFactoryInterface](https://github.com/guilhermegeek/communia/blob/master/src/Pi-Interfaces/ServiceGatewayFactoryInterface.php) and [ServiceGatewayInterface](https://github.com/guilhermegeek/communia/blob/master/src/Pi-Interfaces/ServiceGatewayInterface.php).

By default, the PiHost implements the **ServiceGatewayInterface** with [InProcessServiceGateway](src/Pi/InProcessServiceGateway.php)

Instead

HTTP requests from nginx are executed with the [RestHandler](src/Pi/Host/Handlers/RestHandler.php) invoking [ServiceRegistery](src/Pi/Host/ServiceRegistery.php)->execute($dto, $httpReq)
..+ Finish InProcess implementation for GateWayInterface
..+ Create Ser
..+ Create Gateway Services for a basic implementation: if request exists in serviceMeta->requests() then it's local, otherwise use JsonServiceClient
